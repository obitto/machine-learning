sigma = [1 1;1 4];
mu1 = [1 1];
mu2 = [4 4];
x1 = 0:0.01:5;
x2 = 0:0.01:5;
p1 = 0.8;
p2 = 0.2;
[X1,X2] = meshgrid(x1,x2);
F1 = mvnpdf([X1(:) X2(:)],mu1,sigma);
F1 = reshape(F1,length(x2),length(x1));
F2 = mvnpdf([X1(:) X2(:)],mu2,sigma);
F2 = reshape(F2,length(x2),length(x1));
F1 = F1 * p1;
F2 = F2 * p2;
%boundary = ((F1 * 0.8) > (F2 * 0.2));
boundary = F1 > F2;
contour(x1,x2,F1,6);
hold on;
contour(x1,x2,F2,6);
%contour(x1,x2,boundary);
contour(X1,X2, boundary,[1 0],'LineWidth', 2, 'Color', 'k');
hold off;